# RPC（Remote Procedure Call 远程过程调用）

# 1、RPC & Ajax

## 1.1、概述

* 相同点：
  * 都是两个计算机之间的网络通信；
    * RPC 是服务器与服务器之间的通信；
    * Ajax 是浏览器与服务器之间的通信；
  * 都需要通信双方约定一个数据格式；
* 不同点：
  * 使用不同寻址服务：
    * Ajax 使用 DNS 作为寻址服务；
      * 即，一般浏览器发送 HTTP 请求，要使用 DNS 寻址；
    * RPC 通信一般是在内网里互相请求，使用 DNS 寻址不划算；
  * 交互方式不同：
    * Ajax 应用层协议一般使用 HTTP 文本协议；
    * RPC 通信一般使用 TCP 协议的二进制交互，取代 HTTP 协议的文本交互；
  * 以什么协议作为基础协议不同：
    * Ajax 基于 “HTTP 协议”；
    * RPC 通信基于 “TCP协议” 或 “UDP协议”；

## 1.2、详述

1. RPC 和 Ajax 的不同寻址方式：

   * Ajax 使用 DNS 寻址：

     <img src="https://cdn.nlark.com/yuque/0/2021/jpeg/114317/1623316889221-c2d7cdd8-6ccd-4f44-b96c-b6971dea7e05.jpeg" alt="img" style="zoom:50%;" />

   * RPC 使用特有服务寻址：

     <img src="https://cdn.nlark.com/yuque/0/2021/jpeg/114317/1623321358565-82b9c586-422a-4d33-a673-473874bf3e1c.jpeg" alt="img" style="zoom:50%;" />

2. RPC 和 Ajax 基于不同的通信协议：

   * Ajax 基于 HTTP 协议的通信方式；

   * RPC 基于 TCP（Transmission Control Protocol）协议的通信方式：
     * 单工通信：
       * TCP链接过程中，只能一方向另外一方发数据，只能客户端发数据给服务器，或只能服务器发数据给客户端；
     * 半双工通信
       * 客户端向服务器发送数据，只有经过发送数据的这段时间之后。 服务器才能向客户端发送数据；
       * 服务器向客户端发送数据，只有经过发送数据的这段时间之后。 客户端才能向服务器发送数据；
       *  **可以理解为一个独木桥，一段时间内只能有一个方向的人通过** 
     * 全双工通信
       * 客户端和服务端能自由通信；
       *  **可以理解为双向车道，两个方向互不影响** ；
       *  **问题： 实现难度更大， 成本更高** 

3. RPC 和 Ajax 基于不同协议导致的不同交互方式：
   * Ajax 基于 HTTP 协议的通信方式，是**文本协议**，离程序员近，需要人类理解，故文本协议**可读性更强**；
     * HTML
     * JSON
   * RPC 基于 TCP 协议的通信方式，是**二进制协议**，离计算机近，需要计算机理解，故二进制**编解码更快&体积更小**；
     * 二进制包

# 2、Node.js Buffer 编解码二进制数据包

# 3、Node.js net 建立多路复用 RPC 通道

